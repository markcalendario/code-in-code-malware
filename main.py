from urllib.request import urlopen, Request
from io import BytesIO
import os
from PIL import Image 

def download_image(url):
  try:
    req = Request(url, headers={'User-Agent': 'Mozilla/5.0'})
    response = urlopen(req)
    return Image.open(BytesIO(response.read()))
  except:
    print("Error downloading PUP image.")
    return None

def write_to_pup_logo(file_name, caption, output_path):
  print("Downloading PUP logo...")

  try:
    # Download the image from the URL
    img = download_image(file_name)

    if img is not None:
      img.save(output_path)
      
      with open(output_path, 'a') as file:
        # Write text to the file
        file.write(f'{caption}\n')

    print("PUP logo edited successfully.")

  except Exception as e:
    print(e)

def open_file(file_path):
  os.system(f"start {file_path}")

def start():
  file_name = "https://i.imgur.com/RptYRJ0.png"
  caption = "\n\nPUP - Mark Kenneth Calendario - BSCS 3-1N"
  output_path = "./output.png"

  write_to_pup_logo(file_name, caption, output_path)
  open_file(output_path)

if __name__ == "__main__":
    start()
