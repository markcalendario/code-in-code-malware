from PIL import Image, ImageDraw, ImageFont
from urllib.request import urlopen, Request
from io import BytesIO
import os

def download_image(url):
    try:
        req = Request(url, headers={'User-Agent': 'Mozilla/5.0'})
        response = urlopen(req)
        return Image.open(BytesIO(response.read()))
    except:
        print("Error downloading PUP image.")
        return None

def write_to_pup_logo(file_name, caption, output_path):
  print("Getting PUP logo to write...")

  try:
    # Download the image from the URL
    img = download_image(file_name)

    if img is not None:
      draw = ImageDraw.Draw(img)

      # Set the font and text properties
      font_primary = ImageFont.truetype("arialbd.ttf", 100, encoding="unic")
      font_caption = ImageFont.truetype("arialbd.ttf", 90, encoding="unic")
      fill_color = "blue"
      stroke_color = "black"

      # Write text to the image
      draw.text((50, 350), "PUP", font=font_primary, fill=fill_color, stroke_width=10, stroke_fill=stroke_color)
      draw.text((50, 650), "BSCS 3-1N", font=font_primary, fill=fill_color, stroke_width=10, stroke_fill=stroke_color)
      draw.text((50, 500), caption, font=font_caption, fill=fill_color, stroke_width=5, stroke_fill=stroke_color)

      # Save the image to a file
      img.save(output_path)

      print("PUP logo edited successfully.")

  except Exception as e:
    print(e)

def open_file(file_path):
  os.system(f"start {file_path}")

def start():
  file_name = "https://i.imgur.com/RptYRJ0.png"
  caption = "Calendario, Mark Kenneth"
  output_path = "./output.png"

  write_to_pup_logo(file_name, caption, output_path)
  open_file(output_path)

if __name__ == "__main__":
    start()
